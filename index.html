<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Konquest-HTML5</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="css/foundation.css" />
  <script src="js/vendor/modernizr.js"></script>
  <meta name="description" content="A galactic strategy game">
  <meta name="author" content="Heikki Ketoharju, Matti HyvÃ¶nen">

  <link rel="stylesheet" href="css/style.css">

  <!--[if lt IE 9]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
</head>

<body>
  <script src="js/scripts.js"></script>
  <script src="js/table.js"></script>
  <script src="js/planets.js"></script>
  
  <div id="content">
  
    <div id="top-bar" class="row">
      <form name="tablecreator" action="">
        <div class="large-4 columns">
            <input type="text" name="x" value="16" />
        </div>
        <div class="large-4 columns">
            <input type="text" name="y" value="16" />
        </div>
        <div class="large-4 columns">
          <input class="button tiny" type="button" value="generoi" onclick="drawGrid();">
        </div>
      </form>
    </div>
    
    <div class="row">
      <div class="large-10 columns">
        <table cellspacing="0" cellpadding="0" id="spacegrid">
        </table>
      </div>
      <div class="large-2 columns" id="statusdisplay">
        <div id="request">
          <h3 style="color: #aaa;">An AJAX request test</h3>
          <button class="button tiny" id="requestButton">Make a request</a>
          <button class="button tiny" id="clearButton" onclick="emptyRequest();">Clear</button>
          <button class="button tiny" id="clearButton" onclick="console.log(konquestData); drawPlanets();">Get JSON</button>

          <div id="result"></div>
        </div>
        <div id="planetinfo" class="hide">
          <p>Planet info</p>
          <ul>
            <li class="name"></li>
            <li class="killPercent"></li>
            <li class="productionRate"></li>
            <li class="ships"></li>
          </ul>
        </div>
      </div>
    </div>
  
  <script src="js/vendor/jquery.js"></script>
  <script src="js/foundation.min.js"></script>
  <script>
    $(document).foundation();
    drawGrid();
    
    //Load data
    var konquestData = {};
    var url = "https://heikkiket.kapsi.fi/"
            + "konquest-html5/php_server/"
            + "g/asdasdasd"
            + "/read";
    $.getJSON(url, function(json) {
      konquestData = json;
    });
    
    //Create test AJAX request
    (function() {
      var httpRequest;
      document.getElementById("requestButton").onclick = function() { makeRequest('test.txt'); };

      function makeRequest(url) {
        if(window.XMLHttpRequest) { //Mozilla, Safari, ...
          httpRequest = new XMLHttpRequest();
        } else if (window.ActiveXObject) { // IE
          try {
            httpRequest = new ActiveXObject("Msxml2.XMLHTTP");
          }
          catch(e) {
            try {
              httpRequest = new ActiveXObject("Microsoft.XMLHTTP");
            }
            catch (e) {}
          }
        }

        if (!httpRequest) {
          console.log("Cannot create XMLHTTP instance");
          return false;
        }
        httpRequest.onreadystatechange = alertContents;
        httpRequest.open('GET', url);
        httpRequest.send();
      }

      function alertContents() {
        if (httpRequest.readyState === 4) {
          if (httpRequest.status === 200) {
            $( "#result" ).html(httpRequest.responseText);
          } else {
            console.log("There was a problem with the request");
          }
        }
      }

    })();

    function emptyRequest() {
        $( "#result" ).empty();
    }
  </script>
</body>
</html>
